# Project Report — Interpretable Machine Learning for Credit Risk (SHAP & LIME)

## Objective
Build a predictive model for binary credit default risk and interpret it using at least two model-agnostic techniques: SHAP and LIME. Contrast global and local explanations and provide business-focused recommendations derived from the interpretability outputs.

## Dataset
A synthetic anonymized dataset (`credit_risk_synthetic.csv`) with 5,000 rows and the following features:
- loan_amnt, term, int_rate, grade, emp_length, home_ownership, annual_inc, dti, delinq_2yrs, revol_util, total_acc, purpose, age
- target: `default` (0 = no default, 1 = default)

## Modeling approach
- Preprocessing: Standard scaling for numeric features and one-hot encoding for categorical features.
- Model: Gradient Boosting Classifier (scikit-learn) with modest hyperparameters for robust performance.
- Evaluation: AUC (primary), Precision, Recall, Classification report.

## Interpretability approach
- SHAP (global & local) to identify the most important features globally and to generate local attributions for individual borrowers.
- LIME (local) to create local surrogate explanations for the same borrower cases and compare feature attributions.

## Deliverables produced by `main.py`
1. `model.joblib` — saved trained pipeline.
2. `metrics.json` — evaluation metrics (AUC, precision, recall).
3. `shap_summary.png` — SHAP global summary plot (if SHAP installed).
4. `shap_*` and `lime_*` per-case explanations (if libraries installed).
5. `case_shap_case_*.png` — SHAP waterfall plots per case (if SHAP installed).

## Example findings (to be produced when you run the code locally)
- Top risk drivers expected: higher `int_rate`, higher `dti`, higher `delinq_2yrs`, high `revol_util`, lower `annual_inc`.
- Business implication: tighten underwriting thresholds for applicants with high DTI and recent delinquencies; consider offering lower interest rates or smaller loan amounts to marginal borrowers with elevated revol_util.

## Actionable recommendations for credit approval process
1. Flag borrowers with combination of: `int_rate > 18%`, `dti > 30`, `delinq_2yrs >= 1`, `revol_util > 70` for manual review.
2. Introduce staged approvals with conditions (lower loan amounts / cosigner requirement) for borderline cases identified by SHAP & LIME disagreement.
3. Monitor feature drift: track average DTI, revol_util, and delinq_2yrs over time; retrain quarterly.

## How to reproduce & extend
- Tune model via cross-validation and grid/randomized search for AUC optimization.
- Add calibrated probability threshold based on business loss matrix to improve precision/recall tradeoff.
- Provide regulatory documentation mapping model inputs to adverse action reasons (use SHAP global feature importances to justify top drivers).

---
This report was autogenerated as a template. Run `python main.py` locally to generate actual plots and numeric metrics and paste them into this report for submission.
